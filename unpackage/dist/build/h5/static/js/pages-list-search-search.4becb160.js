(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-list-search-search"],{"0b5b":function(e,t,a){var i=a("e8a7");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=a("4f06").default;n("02513d35",i,!0,{sourceMap:!1,shadowMode:!1})},"1e02":function(e,t,a){"use strict";a.r(t);var i=a("eef8"),n=a.n(i);for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);t["default"]=n.a},"68c5":function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return i}));var i={uniSearchBar:a("de64").default,unicloudDb:a("960d").default,uniList:a("77b0").default,uniListItem:a("79ba").default},n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"container"},[a("v-uni-view",{staticClass:"search-container"},[a("v-uni-view",{staticClass:"search-container-bar"},[a("uni-search-bar",{ref:"searchBar",staticStyle:{flex:"1"},attrs:{radius:"100",focus:e.focus,placeholder:e.hotWorld,clearButton:"auto",cancelButton:"always"},on:{clear:function(t){arguments[0]=t=e.$handleEvent(t),e.clear.apply(void 0,arguments)},confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.confirm.apply(void 0,arguments)},cancel:function(t){arguments[0]=t=e.$handleEvent(t),e.cancel.apply(void 0,arguments)}},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}})],1)],1),a("v-uni-view",{staticClass:"search-body"},[e.localSearchList.length?a("v-uni-view",{staticClass:"word-container"},[a("v-uni-view",{staticClass:"word-container_header"},[a("v-uni-text",{staticClass:"word-container_header-text"},[e._v("搜索历史")]),e.localSearchListDel?a("v-uni-view",{staticClass:"flex-center flex-row",staticStyle:{"font-weight":"500","justify-content":"space-between"}},[a("v-uni-text",{staticStyle:{"font-size":"22rpx",color:"#666","padding-top":"4rpx","padding-bottom":"4rpx","padding-right":"20rpx"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.LocalSearchListClear.apply(void 0,arguments)}}},[e._v("全部删除")]),a("v-uni-text",{staticStyle:{"font-size":"22rpx",color:"#c0402b","padding-top":"4rpx","padding-bottom":"4rpx","padding-left":"20rpx"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.localSearchListDel=!1}}},[e._v("完成")])],1):a("uni-icons",{staticClass:"search-icons",staticStyle:{"padding-right":"0"},attrs:{color:e.iconColor,size:"18",type:"trash"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.localSearchListDel=!0}}})],1),a("v-uni-view",{staticClass:"word-container_body"},e._l(e.localSearchList,(function(t,i){return a("v-uni-view",{key:i,staticClass:"flex-center flex-row word-container_body-text",on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.LocalSearchlistItemClick(t,i)}}},[a("v-uni-text",{key:t,staticClass:"word-display"},[e._v(e._s(t))]),e.localSearchListDel?a("uni-icons",{attrs:{size:"12",type:"closeempty"}}):e._e()],1)})),1)],1):e._e(),a("v-uni-view",{staticClass:"word-container"},[a("v-uni-view",{staticClass:"word-container_header"},[a("v-uni-view",{staticClass:"flex-center flex-row"},[a("v-uni-text",{staticClass:"word-container_header-text"},[e._v("搜索发现")]),e.netHotListIsHide?e._e():a("uni-icons",{staticClass:"search-icons",attrs:{color:e.iconColor,size:"14",type:"reload"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.searchHotRefresh.apply(void 0,arguments)}}})],1),a("uni-icons",{staticClass:"search-icons",staticStyle:{"padding-right":"0"},attrs:{color:e.iconColor,size:"18",type:e.netHotListIsHide?"eye-slash":"eye"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.netHotListIsHide=!e.netHotListIsHide}}})],1),a("unicloud-db",{ref:"udb",attrs:{field:"content",collection:"opendb-search-hot",orderby:"create_date desc,count desc","page-data":"replace","page-size":10},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.data,n=t.loading,o=t.error;t.options;return[n&&!e.netHotListIsHide?a("v-uni-text",{staticClass:"word-container_body-info"},[e._v("正在加载...")]):a("v-uni-view",{staticClass:"word-container_body"},[e.netHotListIsHide?a("v-uni-view",{staticStyle:{flex:"1"}},[a("v-uni-text",{staticClass:"word-container_body-info"},[e._v("当前搜索发现已隐藏")])],1):[o?a("v-uni-text",{staticClass:"word-container_body-info"},[e._v(e._s(o.message))]):e._l(i,(function(t,i){return a("v-uni-text",{key:i,staticClass:"word-container_body-text",on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.search(t.content)}}},[e._v(e._s(t.content))])}))]],2)]}}])})],1)],1),e.associativeShow?a("v-uni-view",{staticClass:"search-associative"},[a("uni-list",e._l(e.associativeList,(function(t,i){return a("uni-list-item",{key:t._id,attrs:{ellipsis:1,title:t.name,"show-extra-icon":!0,clickable:!0,"extra-icon":{size:18,color:e.iconColor,type:"search"}},on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.associativeClick(t)}}})})),1)],1):e._e()],1)},o=[]},"8ff5":function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* uni.scss */\n/* uni.scss */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.status-bar[data-v-57e74e5e]{background-color:#fff}.container[data-v-57e74e5e]{height:100%;flex:1;background-color:#f7f7f7}.search-body[data-v-57e74e5e]{background-color:#fff;border-bottom-right-radius:10px;border-bottom-left-radius:10px}.flex-center[data-v-57e74e5e]{display:flex;justify-content:center;align-items:center}.flex-row[data-v-57e74e5e]{display:flex;flex-direction:row}[data-v-57e74e5e]\n.uni-searchbar__box{border-width:0}[data-v-57e74e5e]\n.uni-input-placeholder{font-size:%?28?%}.search-container[data-v-57e74e5e]{height:52px;display:flex;flex-direction:column;justify-content:center;align-items:center;position:relative;background-color:#fff}.search-container-bar[data-v-57e74e5e]{display:flex;flex-direction:row;justify-content:center;align-items:center;position:absolute;top:0;left:0;right:0}.search-associative[data-v-57e74e5e]{overflow-y:auto;position:absolute;top:52px;left:0;right:0;bottom:0;background-color:#fff;margin-top:%?10?%;padding-left:%?10?%;padding-right:%?10?%}.search-icons[data-v-57e74e5e]{padding:%?16?%}.word-display[data-v-57e74e5e]{font-size:%?26?%;color:#666}.word-container[data-v-57e74e5e]{padding:%?20?%}.word-container_header[data-v-57e74e5e]{display:flex;height:%?72?%;line-height:%?72?%;flex-direction:row;justify-content:space-between;align-items:center}.word-container_header-text[data-v-57e74e5e]{color:#3e3e3e;font-size:%?30?%;font-weight:700}.word-container_body[data-v-57e74e5e]{display:flex;flex-wrap:wrap;flex-direction:row}.word-container_body-text[data-v-57e74e5e]{display:flex;font-size:%?26?%;color:#666;justify-content:center;align-items:center;background-color:#f6f6f6;padding:%?10?% %?20?%;margin:%?20?% %?30?% 0 0;border-radius:%?30?%;box-sizing:border-box;text-align:center}.word-container_body-info[data-v-57e74e5e]{display:block;flex:1;text-align:center;font-size:%?26?%;color:grey;margin-top:%?20?%}',""]),e.exports=t},a5bd:function(e,t,a){"use strict";a.r(t);var i=a("68c5"),n=a("1e02");for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);a("b5e3"),a("cdff");var c=a("f0c5"),s=Object(c["a"])(n["default"],i["b"],i["c"],!1,null,"57e74e5e",null,!1,i["a"],void 0);t["default"]=s.exports},ace7:function(e,t,a){var i=a("8ff5");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=a("4f06").default;n("54528675",i,!0,{sourceMap:!1,shadowMode:!1})},b5e3:function(e,t,a){"use strict";var i=a("0b5b"),n=a.n(i);n.a},cdff:function(e,t,a){"use strict";var i=a("ace7"),n=a.n(i);n.a},e8a7:function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,"\nuni-page-body[data-v-57e74e5e]{height:100%;flex:1}\n",""]),e.exports=t},eef8:function(e,t,a){"use strict";(function(e){a("7a82");var i=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(a("ade3"));a("c975"),a("baa5"),a("a434"),a("ac1f"),a("841c"),a("3c65"),a("d3b7"),a("d401"),a("25f0"),a("4d63"),a("c607"),a("2c3e");var o={data:function(){return{mallGoodsDbName:"opendb-news-articles",searchLogDbName:"opendb-search-log",statusBarHeight:"0px",localSearchList:uni.getStorageSync("__local_search_history"),localSearchListDel:!1,netHotListIsHide:!1,searchText:"",iconColor:"#999999",associativeList:[],keyBoardPopup:!1,hotWorld:"DCloud",focus:!0,speechEngine:"iFly"}},created:function(){this.db=e.database(),this.searchLogDb=this.db.collection(this.searchLogDbName),this.mallGoodsDb=this.db.collection(this.mallGoodsDbName),this.searchText=getApp().globalData.searchText},computed:{associativeShow:function(){return this.searchText&&this.associativeList.length}},onLoad:function(){},methods:{clear:function(e){console.log("res: ",e)},confirm:function(e){this.search(e.value)},cancel:function(e){uni.hideKeyboard(),this.searchText="",this.loadList()},search:function(e){(e||this.hotWorld)&&(e?(this.searchText!==e&&(this.searchText=e),this.localSearchListManage(e),this.searchLogDbAdd(e)):this.hotWorld&&(this.searchText=this.hotWorld),uni.hideKeyboard(),this.loadList(this.searchText))},localSearchListManage:function(e){var t=uni.getStorageSync("__local_search_history");t.length?(this.localSearchList.unshift(e),function(e){for(var t=e.length-1;t>=0;t--){var a=e.indexOf(e[t]),i=e.lastIndexOf(e[t]);a!=i&&e.splice(i,1)}}(this.localSearchList),this.localSearchList.length>10&&this.localSearchList.pop()):this.localSearchList=[e],uni.setStorageSync("__local_search_history",this.localSearchList)},LocalSearchListClear:function(){var e=this;uni.showModal({content:"确认清空搜索历史吗",confirmText:"删除",confirmColor:"red",cancelColor:"#808080",success:function(t){t.confirm&&(e.localSearchListDel=!1,e.localSearchList=[],uni.removeStorageSync("__local_search_history"))}})},LocalSearchlistItemClick:function(e,t){if(this.localSearchListDel)return this.localSearchList.splice(t,1),uni.setStorageSync("__local_search_history",this.localSearchList),void(this.localSearchList.length||(this.localSearchListDel=!1));this.search(e)},searchHotRefresh:function(){this.$refs.udb.refresh()},speech:function(){},searchLogDbAdd:function(e){var t=this;this.getDeviceId().then((function(a){t.searchLogDb.add({device_id:a,content:e,create_date:Date.now()})}))},getDeviceId:function(){return new Promise((function(e,t){var a=uni.getStorageSync("uni_id");e(a||uni.getSystemInfoSync().system+"_"+Math.random().toString(36).substr(2))}))},associativeClick:function(e){console.log("associativeClick: ",e),this.loadList(e.title)},loadList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";getApp().globalData.searchText=e,uni.switchTab({url:"/pages/list/list"})},backPage:function(){uni.navigateBack()}},watch:{searchText:function(e,t,a){var i=e,n=null,o=!0;return a&&i(),function(){var e=arguments,a=this;o&&(o=!1,i.apply(a,e)),n&&clearTimeout(n),n=setTimeout((function(){clearTimeout(n),n=null,i.apply(a,e)}),t||200)}}((function(e){var t=this;e?this.mallGoodsDb.where((0,n.default)({},"title",new RegExp(e,"gi"))).field("_id,title").get().then((function(e){t.associativeList=e.result.data})):(this.associativeList.length=0,getApp().globalData.searchText="")}),100)}};t.default=o}).call(this,a("a9ff")["default"])}}]);
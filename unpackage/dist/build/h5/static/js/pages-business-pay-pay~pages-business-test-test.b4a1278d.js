(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-business-pay-pay~pages-business-test-test"],{"0caa":function(e,t,r){"use strict";r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return n})),r.d(t,"a",(function(){return a}));var a={uniList:r("77b0").default,uniListItem:r("79ba").default},p=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-uni-view",{staticClass:"uni-pay"},["pc"===e.modeCom?r("uni-popup",{ref:"payPopup",attrs:{type:"center","safe-area":!1}},[r("v-uni-view",{staticClass:"pc-pay-popup"},[r("v-uni-view",{staticClass:"pc-pay-popup-title"},[e._v("收银台")]),r("v-uni-view",{staticClass:"pc-pay-popup-flex"},[r("v-uni-view",{staticClass:"pc-pay-popup-qrcode-box"},[r("v-uni-image",{staticClass:"pc-pay-popup-qrcode-image",attrs:{src:e.res.qr_code_image}}),r("v-uni-view",{staticClass:"pc-pay-popup-amount-box"},[r("v-uni-view",{staticClass:"pc-pay-popup-amount-tips"},[e._v("扫一扫付款")]),r("v-uni-view",{staticClass:"pc-pay-popup-amount"},[e._v(e._s((e.options.total_fee/100).toFixed(2)))])],1),e.res.qr_code_image?r("v-uni-view",{staticClass:"pc-pay-popup-complete-button"},[r("v-uni-button",{attrs:{type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e._getOrder()}}},[e._v("我已完成支付")])],1):e._e()],1),r("v-uni-view",{staticClass:"pc-pay-popup-provider-list"},[e.currentProviders.indexOf("wxpay")>-1?r("v-uni-view",{staticClass:"pc-pay-popup-provider-item",class:"wxpay"==e.options.provider?"active":"",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e._pcChooseProvider("wxpay")}}},[r("v-uni-image",{staticClass:"pc-pay-popup-provider-image",attrs:{src:e.images.wxpay}}),r("v-uni-text",{staticClass:"pc-pay-popup-provider-text"},[e._v("微信支付")])],1):e._e(),e.currentProviders.indexOf("alipay")>-1?r("v-uni-view",{staticClass:"pc-pay-popup-provider-item",class:"alipay"==e.options.provider?"active":"",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e._pcChooseProvider("alipay")}}},[r("v-uni-image",{staticClass:"pc-pay-popup-provider-image",attrs:{src:e.images.alipay}}),r("v-uni-text",{staticClass:"pc-pay-popup-provider-text"},[e._v("支付宝支付")])],1):e._e(),r("v-uni-view",{staticClass:"pc-pay-popup-logo"},[r("v-uni-image",{attrs:{src:e.logo,mode:"widthFix"}})],1)],1)],1)],1)],1):r("uni-popup",{ref:"payPopup",attrs:{type:"bottom","safe-area":!1}},[r("v-uni-view",{staticClass:"mobile-pay-popup",style:"min-height: "+e.height+";"},[r("v-uni-view",{staticClass:"mobile-pay-popup-title"},[e._v("收银台")]),r("v-uni-view",{staticClass:"mobile-pay-popup-amount-box"},[r("v-uni-view",[e._v("待支付金额：")]),r("v-uni-view",{staticClass:"mobile-pay-popup-amount"},[e._v(e._s((e.options.total_fee/100).toFixed(2)))])],1),r("v-uni-view",{staticClass:"mobile-pay-popup-provider-list"},[r("uni-list",[e.currentProviders.indexOf("wxpay")>-1?r("uni-list-item",{attrs:{thumb:e.images.wxpay,title:"微信支付",clickable:!0,link:!0},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.createOrder({provider:"wxpay"})}}}):e._e(),e.currentProviders.indexOf("alipay")>-1?r("uni-list-item",{attrs:{thumb:e.images.alipay,title:"支付宝",clickable:!0,link:!0},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.createOrder({provider:"alipay"})}}}):e._e()],1)],1)],1)],1),r("uni-popup",{ref:"qrcodePopup",attrs:{type:"center","safe-area":!1,animation:!1,"mask-click":!1},on:{close:function(t){arguments[0]=t=e.$handleEvent(t),e.clearQrcode.apply(void 0,arguments)}}},[r("v-uni-view",{staticClass:"qrcode-popup-content"},[r("v-uni-image",{staticClass:"qrcode-image",attrs:{src:e.res.qr_code_image}}),r("v-uni-view",{staticClass:"qrcode-popup-info"},[r("v-uni-view",[r("v-uni-text",{staticClass:"qrcode-popup-info-fee"},[e._v(e._s((e.options.total_fee/100).toFixed(2)))]),r("v-uni-text",[e._v("元")])],1),"wxpay"==e.options.provider?r("v-uni-view",[e._v("请用微信扫码支付")]):"alipay"==e.options.provider?r("v-uni-view",[e._v("请用支付宝扫码支付")]):e._e()],1),r("v-uni-button",{attrs:{type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e._getOrder()}}},[e._v("我已完成支付")]),r("v-uni-view",{staticClass:"qrcode-popup-cancel",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.closePopup("qrcodePopup")}}},[e._v("暂不支付")])],1)],1),r("uni-popup",{ref:"payConfirmPopup",attrs:{type:"center","safe-area":!1,animation:!1,"mask-click":!1}},[r("v-uni-view",{staticClass:"pay-confirm-popup-content"},[r("v-uni-view",{staticClass:"pay-confirm-popup-title"},[e._v("请确认支付是否已完成")]),r("v-uni-view",[r("v-uni-button",{attrs:{type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e._getOrder()}}},[e._v("已完成支付")])],1),r("v-uni-view",{staticClass:"pay-confirm-popup-refresh"},[r("v-uni-button",{attrs:{type:"default"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e._afreshPayment()}}},[e._v("支付遇到问题，重新支付")])],1),r("v-uni-view",{staticClass:"pay-confirm-popup-cancel",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.closePopup("payConfirmPopup")}}},[e._v("暂不支付")])],1)],1)],1)},n=[]},"370e":function(e,t,r){var a=r("24fb");t=a(!1),t.push([e.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* uni.scss */\n/* uni.scss */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.uni-pay[data-v-daeb3c08]{--bgcolor:#f3f3f3}\n/* 手机版收银台弹窗开始 */.mobile-pay-popup[data-v-daeb3c08]{min-height:70vh;background-color:var(--bgcolor);border-radius:%?30?% %?30?% 0 0;overflow:hidden}.mobile-pay-popup .mobile-pay-popup-title[data-v-daeb3c08]{background-color:#fff;text-align:center;font-weight:700;font-size:%?40?%;padding:%?20?%}.mobile-pay-popup .mobile-pay-popup-amount-box[data-v-daeb3c08]{background-color:#fff;padding:%?30?%}.mobile-pay-popup .mobile-pay-popup-amount-box .mobile-pay-popup-amount[data-v-daeb3c08]{color:#e43d33;font-size:%?60?%;margin-top:%?20?%}.mobile-pay-popup .mobile-pay-popup-provider-list[data-v-daeb3c08]{background-color:#fff;margin-top:%?20?%}\n/* 手机版收银台弹窗结束 */\n/* PC版收银台弹窗开始 */.pc-pay-popup[data-v-daeb3c08]{width:800px;height:600px;background-color:var(--bgcolor);border-radius:10px;overflow:hidden}.pc-pay-popup .pc-pay-popup-title[data-v-daeb3c08]{background-color:#fff;text-align:center;font-weight:700;font-size:20px;height:66px;line-height:66px}.pc-pay-popup .pc-pay-popup-flex[data-v-daeb3c08]{width:100%;display:flex}.pc-pay-popup .pc-pay-popup-flex .pc-pay-popup-qrcode-box[data-v-daeb3c08]{height:calc(600px - 66px);flex:1;background-color:#fff;display:flex;flex-direction:column;justify-content:center;align-items:center}.pc-pay-popup .pc-pay-popup-flex .pc-pay-popup-qrcode-box .pc-pay-popup-qrcode-image[data-v-daeb3c08]{width:225px;height:225px}.pc-pay-popup .pc-pay-popup-flex .pc-pay-popup-qrcode-box .pc-pay-popup-amount-box[data-v-daeb3c08]{text-align:center}.pc-pay-popup .pc-pay-popup-flex .pc-pay-popup-qrcode-box .pc-pay-popup-amount-box .pc-pay-popup-amount-tips[data-v-daeb3c08]{color:#333;font-size:20px;margin-top:20px}.pc-pay-popup .pc-pay-popup-flex .pc-pay-popup-qrcode-box .pc-pay-popup-amount-box .pc-pay-popup-amount[data-v-daeb3c08]{color:#dd524d;font-weight:700;font-size:32px;margin-top:20px}.pc-pay-popup .pc-pay-popup-flex .pc-pay-popup-qrcode-box .pc-pay-popup-complete-button[data-v-daeb3c08]{margin-top:20px}.pc-pay-popup .pc-pay-popup-flex .pc-pay-popup-provider-list[data-v-daeb3c08]{width:300px;display:flex;flex-direction:column}.pc-pay-popup .pc-pay-popup-flex .pc-pay-popup-provider-list .pc-pay-popup-provider-item[data-v-daeb3c08]{padding:20px;display:flex;align-items:center}.pc-pay-popup .pc-pay-popup-flex .pc-pay-popup-provider-list .pc-pay-popup-provider-item .pc-pay-popup-provider-image[data-v-daeb3c08]{width:60px;height:60px}.pc-pay-popup .pc-pay-popup-flex .pc-pay-popup-provider-list .pc-pay-popup-provider-item .pc-pay-popup-provider-text[data-v-daeb3c08]{color:#333;font-size:20px;margin-left:10px}.pc-pay-popup .pc-pay-popup-flex .pc-pay-popup-provider-list .pc-pay-popup-provider-item.active[data-v-daeb3c08]{background-color:#fff}.pc-pay-popup .pc-pay-popup-flex .pc-pay-popup-provider-list .pc-pay-popup-provider-item[data-v-daeb3c08]:hover{background-color:#fff;cursor:pointer}.pc-pay-popup .pc-pay-popup-flex .pc-pay-popup-provider-list .pc-pay-popup-logo[data-v-daeb3c08]{flex:1;display:flex;align-items:center;justify-content:center}.pc-pay-popup .pc-pay-popup-flex .pc-pay-popup-provider-list .pc-pay-popup-logo uni-image[data-v-daeb3c08]{width:120px}\n/* PC版收银台弹窗结束 */\n/* 二维码支付弹窗开始 */.qrcode-popup-content[data-v-daeb3c08]{width:%?600?%;background-color:#fff;border-radius:%?10?%;padding:%?40?%;box-sizing:border-box;text-align:center}.qrcode-popup-content .qrcode-image[data-v-daeb3c08]{width:%?450?%;height:%?450?%}.qrcode-popup-content .qrcode-popup-info[data-v-daeb3c08]{text-align:center;padding:%?20?%}.qrcode-popup-content .qrcode-popup-info .qrcode-popup-info-fee[data-v-daeb3c08]{color:red;font-size:%?60?%;font-weight:700}.qrcode-popup-content .qrcode-popup-cancel[data-v-daeb3c08]{margin-top:%?20?%;text-align:center}\n/* 二维码支付弹窗结束 */\n/* 外部浏览器H5支付弹窗确认开始 */.pay-confirm-popup-content[data-v-daeb3c08]{width:%?550?%;background-color:#fff;border-radius:%?10?%;padding:%?40?%}.pay-confirm-popup-content .pay-confirm-popup-title[data-v-daeb3c08]{text-align:center;padding:%?20?% 0;margin-bottom:%?30?%}.pay-confirm-popup-content .pay-confirm-popup-refresh[data-v-daeb3c08]{margin-top:%?20?%}.pay-confirm-popup-content .pay-confirm-popup-cancel[data-v-daeb3c08]{margin-top:%?20?%;text-align:center}\n/* 外部浏览器H5支付弹窗确认结束 */',""]),e.exports=t},"8fc2":function(e,t,r){var a=r("370e");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var p=r("4f06").default;p("43a61d36",a,!0,{sourceMap:!1,shadowMode:!1})},"9c23":function(e,t,r){"use strict";r.r(t);var a=r("fa9f"),p=r.n(a);for(var n in a)["default"].indexOf(n)<0&&function(e){r.d(t,e,(function(){return a[e]}))}(n);t["default"]=p.a},b0f1:function(e,t,r){"use strict";r("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r("d3b7"),r("c975"),r("ac1f"),r("466d"),r("a9e3"),r("d401"),r("25f0"),r("00b4"),r("5319"),r("4d63"),r("c607"),r("2c3e");var a={getWeixinCode:function(){return new Promise((function(e,t){}))},getAlipayCode:function(){},checkPlatform:function(){var e={win:!1,mac:!1,xll:!1},t=navigator.platform;if(e.win=0==t.indexOf("Win"),e.mac=0==t.indexOf("Mac"),e.x11="X11"==t||0==t.indexOf("Linux"),e.win||e.mac||e.xll){var r=navigator.userAgent.toLowerCase();return r.indexOf("micromessenger")>-1?"pc-weixin":"pc"}return t.indexOf("iPhone")>-1||t.indexOf("iPad")>-1?"ios":"android"},getH5Env:function(){var e=window.navigator.userAgent.toLowerCase();return"micromessenger"==e.match(/MicroMessenger/i)&&"miniprogram"==e.match(/miniprogram/i)?"mp-weixin":"micromessenger"==e.match(/MicroMessenger/i)?"h5-weixin":"alipay"==e.match(/alipay/i)&&"miniprogram"==e.match(/miniprogram/i)?"mp-alipay":"alipay"==e.match(/alipay/i)?"h5-alipay":"h5"},timeFormat:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-MM-dd hh:mm:ss",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8;try{if(!e)return"";var a;"string"!==typeof e||isNaN(e)||(e=Number(e)),"number"===typeof e?(10==e.toString().length&&(e*=1e3),a=new Date(e)):a=e;var p=a.getTimezoneOffset(),n=60*p*1e3+60*r*60*1e3,o=a.getTime()+n;a=new Date(o);var i={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};for(var c in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length))),i)new RegExp("("+c+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[c]:("00"+i[c]).substr((""+i[c]).length)));return t}catch(u){return e}}},p=a;t.default=p},dc9c:function(e,t,r){"use strict";var a=r("8fc2"),p=r.n(a);p.a},f303:function(e,t,r){"use strict";r.r(t);var a=r("0caa"),p=r("9c23");for(var n in p)["default"].indexOf(n)<0&&function(e){r.d(t,e,(function(){return p[e]}))}(n);r("dc9c");var o=r("f0c5"),i=Object(o["a"])(p["default"],a["b"],a["c"],!1,null,"daeb3c08",null,!1,a["a"],void 0);t["default"]=i.exports},fa9f:function(e,t,r){"use strict";(function(e){r("7a82");var a=r("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r("e9c4"),r("d81d"),r("c975"),r("14d9"),r("a4d3"),r("e01a"),r("99af");var p=a(r("c7eb")),n=a(r("1da1")),o=a(r("b0f1")),i=e.importObject("uni-pay-co"),c={name:"uni-pay",emits:["success","cancel","fail","create","mounted","qrcode"],props:{adpid:{Type:String,default:""},toSuccessPage:{Type:Boolean,default:!0},returnUrl:{Type:String,default:""},mainColor:{Type:String,default:""},mode:{Type:String,default:""},logo:{Type:String,default:"/static/logo.png"},height:{Type:[String],default:"70vh"},debug:{Type:Boolean,default:!1}},data:function(){return{options:{},res:{},images:{wxpay:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAABC9JREFUeF7tWk1a20AMlUzv0bDr13AAYAOcpLCBcoqQU1DYEE6C2QAHIP26q3sPPOqniU2cZMYj+SeGxN5kEXlm9ObpjaQxwpY/uOX+Qw9Az4AtR6APgS0nQC+CfQi0FQLfrvcHXwAGPP4bQMK/fy5f7O9HehphwPfb/dOIogEhHQHBcamDCDESPoIxMQPTNSi1ABj+OrwDpNMaO5og4P2bMZOugFADwNTewWhU0/FVzAgnKZnxuoFQAbB3vX9MET7U2PHgq4R09vv8ZRI0bMhADMDw9uAhGN8NLQrWyAYRAGt1PgcRIU5TOms7JIIAdOL8nElJauikTRBKAdi7ObwioFFTzHaMw3mBzRV8DwKOXy+ertpagxcAq/YR/g2d6TlNrUDu4EiiE0Why4T1rgyINoXRC4DgjE+mF8+7RYAkp4RrRyVztRUKTgCkuz89fz4pAiB5z7WbklBrKxScAEgWxI6joZPXy5c4B0H0nkPdhzcHFIxxhHgZ8OA7AgMnAMObA479UnF6H5twQpF5RBMdibPDvB4AAAL6IZ0rNbTb9IngAyC8IwJ0K5okQBgzqFEKSV4wcXg17bxl8fIiJXFc0bHAgYLjYlHEFaZlVUQDoAIbcVZaN1VRrgAgUfImASiKW6Yh4pAohmHVQqpLABI0dMYiKhJPCeoV0ueuQsDmEJrkSeJ/bqNJnOqfApqVzWznzrdYWkvzhnUDYGnPKLTdV5gpfLiOqJUIaTefF8RKH6wxtAOX2IdA8NcCmmRItmBLfVF5jRBnR58kGQtWlGUJlBeAxpQ5A4eFKTu/ufLzPQv1f2mRRDiZ/nyyYwYrypI0OlQOc/9PsgshDsh2v+BUwTFnD3K5DglVlD4WlDZEsqywNgiK2F9gQBkLi7EtyV59WhBsiTURCjy5QZMgYRn9cxbZWgCQ+IKlnH2sFQYTURHmCYMgAJaKs9aYPkXNXGK6QhQdt9xeC4UhTC+eV/wVASASmrKj6IMA4NIBMQDsX1VN4IlbuU0K7vmiQS0G5EOpmiW6I1Dpjtp8pYc5yxYVj0RtXcMJcwDFSiqYLh2x+QgqAJwnAuEEydxbkZtdj+fKPVfwbPIq7KngqvMVX4WoAmDBAcH9HTMmXw23s0LJSlPOOsZx0l8VAu/0Fzjuc2Td3aY5zf1VoZgBvPgmvuhoIrFSMSXQThcDoJo0YLxGLfBSv5IINgVC1XxCOb/oZrkTBtRJqkQgKG6ROgPgPbGq/6HVIiYK51WngAj5ikbBhoZi3FALbHmozhlQXFChTc75g6wRM2ufzb9N/IwMcG0wg8HZJf9HBF/tFZnBBBH+cW/BpBDnd4XLDNJcon4oBiiY7jS194mEI0IaSz+12ygAclSYEcXvFsqA3UgANEzqAdCgtYm2PQM2cVc1PvUM0KC1ibY9AzZxVzU+bT0D/gPs/oxfcUEcJAAAAABJRU5ErkJggg==",alipay:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAA2FJREFUeF7tmU122jAQx2cMB2hp9yULeK+naHISwhJyiIRDBJaQkwRO0fdgEWff0h4ANH0yFc+m+hhbckKNvJUsaX76z4ckhAv/8MLthwggKuDCCUQXuHABxCAYXSC6wIUTiC7wFgL4MPveTaj9optrO+696ya8yeQRQFRAdIEYAxoVBD/PNtdCwHWpDIJwr+1PMCk1DgAkCSx/jHrLsv/p+lfKAp3HzQOYDAqxKtcYBJPtXe/B1Y3TXgmATGst0WIrgAC7JmBINOQsNN8HE0zfVQFlFxzrgFgHNLQOkNJuQ7vrcgkS1CXEua5fgnDj+l+172CX/h59Tbn9Of0qBUE1cGe2ngPhLWeiEH0krFDBT63HC8Cnx/VtFuFDfgl90UOldDvuX4WcSo7lBSD0YuR4H6ebZwRNkRUw9xdSah1G+IzZmW5IW7ERDX/e9Rc+YwerBEMvQo1nrhfqkf/ZuYCxxK5J/t4AjkFQBi71CXxFoFSWq2XTlkn+AndXodNf5SwgT4J7gnttoNL6BqUEmCZET/tkvzQZYj5g1Sf/0goIkfcJYIkEK5HsFnkYnen6BXQptUb5lwJgMz4zCihXD/BqAwVDuoy+Uqx399kACrkZaYECVjY5qxJZXpoQwrcDHB6UghfVvPssAMo35W4R7oZVg5EMmAJxUCZ2CNzfVJ2Pm6qdleDBNwFClaHZdRrQAEhWe25VSPCuAMo1tnQhdIzMNUixfDYBqAOGVQEKQB15OFMCwXPV3QsFww7g73E39Pudr/Gn0EyplQPXCkBF/5AKsBtPKRA+AdKAEx/0BhYLL9nHFkhZLiBvbkOcxFzG5wPtoe7gBUrrTiMttqO+8ebZCkAtWErs17jHvrrSLcj+lkCpKeV5g/ABIA05lqgVM4Er2nPhZgev7DHGnToLG+ALIC9budgWwoRzyuMUPlzj8waVBuELIFOB5iksi7xIKQh8PS4wu8/j+a3vBScbRAgABVfg5BZbH6SFgP0kVIl7UCjNja4RCkAGwecaPLDhp4yNsSYkADlp/mncdNLLu8fpud9XQK7//wERGoBrAefSfgRBsLI9pTtPg+diUNV1yLuJypVg1Un/p/8arwDXZkQALkJNb48KaPoOu+yLCnARanp7VEDTd9hlX1SAi1DT2/8AaakVXysj5qkAAAAASUVORK5CYII="},originalRroviders:["wxpay","alipay"],currentProviders:["wxpay","alipay"]}},mounted:function(){var e=this;return(0,n.default)((0,p.default)().mark((function t(){var r;return(0,p.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=3,e.getPayProviderFromCloud();case 3:r=t.sent,0===r.errCode&&(e.originalRroviders=r.provider,e.currentProviders=JSON.parse(JSON.stringify(e.originalRroviders))),e.$emit("mounted",{images:e.images,originalRroviders:e.originalRroviders,currentProviders:e.currentProviders});case 6:case"end":return t.stop()}}),t)})))()},methods:{open:function(){var e=arguments,t=this;return(0,n.default)((0,p.default)().mark((function r(){var a,n;return(0,p.default)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=e.length>0&&void 0!==e[0]?e[0]:{},a.provider?(n=[],t.originalRroviders.map((function(e,t){a.provider.indexOf(e)>-1&&n.push(e)})),t.currentProviders=n,delete a.provider):t.currentProviders=JSON.parse(JSON.stringify(t.originalRroviders)),t.options=a,1!==t.currentProviders.length){r.next=7;break}t.createOrder({provider:t.currentProviders[0]}),r.next=11;break;case 7:if("pc"!==t.modeCom){r.next=10;break}return r.next=10,t._pcChooseProvider(t.currentProviders[0]);case 10:t.openPopup("payPopup");case 11:case"end":return r.stop()}}),r)})))()},createOrder:function(){var e=arguments,t=this;return(0,n.default)((0,p.default)().mark((function r(){var a,n,c,u;return(0,p.default)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=e.length>0&&void 0!==e[0]?e[0]:{},n=t.options,Object.assign(n,a),"appleiap"!==n.provider){r.next=5;break}return r.abrupt("return",t._appleiapCreateOrder(n));case 5:return"pc"===o.default.checkPlatform()&&(n.qr_code=!0),c={provider:n.provider,total_fee:n.total_fee,openid:void 0,order_no:n.order_no||t.res.order_no,out_trade_no:n.out_trade_no||t.res.out_trade_no,description:n.description,type:n.type,qr_code:n.qr_code,custom:n.custom,other:n.other},n.openid&&"wxpay"===n.provider&&(c.openid=n.openid),r.next=11,i.createOrder(c);case 11:u=r.sent,u.errCode||(t.$emit("create",u),u.qr_code&&!n.cancel_popup?(t.res=u,"pc"===t.modeCom?(t.openPopup("payPopup"),t._pcChooseProvider(n.provider)):t.openPopup("qrcodePopup")):t.orderPayment(u));case 13:case"end":return r.stop()}}),r)})))()},orderPayment:function(e){var t=this;if(this.res=e,e.qr_code)this.$emit("qrcode",e);else if(e.order)if("jsapi"===e.provider_pay_type)WeixinJSBridge.invoke("getBrandWCPayRequest",e.order,(function(e){"get_brand_wcpay_request:ok"==e.err_msg?t._getOrder():"get_brand_wcpay_request:cancel"==e.err_msg?t.$emit("cancel",e):"get_brand_wcpay_request:fail"==e.err_msg&&(console.error("getBrandWCPayRequest-fail: ",e),t.$emit("fail",e))}));else{var r=e.order.codeUrl,a=e.order.mwebUrl||e.order.mweb_url;setTimeout((function(){t.openPopup("payConfirmPopup"),window.location.href=r||a}),200)}},openPopup:function(e){this.$refs[e].showPopup||this.$refs[e].open()},closePopup:function(e){this.$refs[e].close()},getOrder:function(){var e=arguments;return(0,n.default)((0,p.default)().mark((function t(){var r,a;return(0,p.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:{},t.prev=1,t.next=4,i.getOrder(r);case 4:return a=t.sent,"function"===typeof r.success&&r.success(a),t.abrupt("return",a);case 9:t.prev=9,t.t0=t["catch"](1),"function"===typeof r.fail&&r.fail(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))()},refund:function(){var e=arguments;return(0,n.default)((0,p.default)().mark((function t(){var r,a;return(0,p.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:{},t.prev=1,t.next=4,i.refund(r);case 4:return a=t.sent,"function"===typeof r.success&&r.success(a),t.abrupt("return",a);case 9:t.prev=9,t.t0=t["catch"](1),"function"===typeof r.fail&&r.fail(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))()},getRefund:function(){var e=arguments;return(0,n.default)((0,p.default)().mark((function t(){var r,a;return(0,p.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:{},t.prev=1,t.next=4,i.getRefund(r);case 4:return a=t.sent,"function"===typeof r.success&&r.success(a),t.abrupt("return",a);case 9:t.prev=9,t.t0=t["catch"](1),"function"===typeof r.fail&&r.fail(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))()},closeOrder:function(){var e=arguments;return(0,n.default)((0,p.default)().mark((function t(){var r,a;return(0,p.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:{},t.prev=1,t.next=4,i.closeOrder(r);case 4:return a=t.sent,"function"===typeof r.success&&r.success(a),t.abrupt("return",a);case 9:t.prev=9,t.t0=t["catch"](1),"function"===typeof r.fail&&r.fail(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))()},getPayProviderFromCloud:function(){var e=arguments;return(0,n.default)((0,p.default)().mark((function t(){var r,a;return(0,p.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:{},t.prev=1,t.next=4,i.getPayProviderFromCloud(r);case 4:return a=t.sent,"function"===typeof r.success&&r.success(a),t.abrupt("return",a);case 9:t.prev=9,t.t0=t["catch"](1),"function"===typeof r.fail&&r.fail(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))()},getProviderAppId:function(){var e=arguments;return(0,n.default)((0,p.default)().mark((function t(){var r,a;return(0,p.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:{},t.prev=1,t.next=4,i.getProviderAppId(r);case 4:return a=t.sent,"function"===typeof r.success&&r.success(a),t.abrupt("return",a);case 9:t.prev=9,t.t0=t["catch"](1),"function"===typeof r.fail&&r.fail(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))()},getOpenid:function(){var e=arguments;return(0,n.default)((0,p.default)().mark((function t(){var r,a;return(0,p.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:{},t.prev=1,t.next=4,i.getOpenid(r);case 4:return a=t.sent,"function"===typeof r.success&&r.success(a),t.abrupt("return",a);case 9:t.prev=9,t.t0=t["catch"](1),"function"===typeof r.fail&&r.fail(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))()},verifyReceiptFromAppleiap:function(){var e=arguments;return(0,n.default)((0,p.default)().mark((function t(){var r,a;return(0,p.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:{},t.prev=1,t.next=4,i.verifyReceiptFromAppleiap(r);case 4:return a=t.sent,"function"===typeof r.success&&r.success(a),t.abrupt("return",a);case 9:t.prev=9,t.t0=t["catch"](1),"function"===typeof r.fail&&r.fail(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))()},getCode:function(){return(0,n.default)((0,p.default)().mark((function e(){return(0,p.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},paySuccess:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.closePopup("payPopup"),this.closePopup("payConfirmPopup"),this.clearQrcode(),this.toSuccessPage&&this.pageToSuccess(e),this.$emit("success",e)},pageToSuccess:function(e){if("pc"!==this.modeCom)uni.navigateTo({url:"/uni_modules/uni-pay/pages/success/success?out_trade_no=".concat(e.out_trade_no,"&order_no=").concat(e.pay_order.order_no,"&pay_date=").concat(e.pay_order.pay_date,"&total_fee=").concat(e.pay_order.total_fee,"&adpid=").concat(this.adpid,"&return_url=").concat(this.returnUrl,"&main_color=").concat(this.mainColor)});else if(this.returnUrl){var t=this.returnUrl+"?out_trade_no=".concat(e.out_trade_no,"&order_no=").concat(e.pay_order.order_no);0!==t.indexOf("/")&&(t="/".concat(t)),uni.navigateTo({url:t})}},clearQrcode:function(){this.res.codeUrl="",this.res.qr_code_image=""},_getOrder:function(){var e=this;return(0,n.default)((0,p.default)().mark((function t(){return(0,p.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getOrder({out_trade_no:e.res.out_trade_no,await_notify:!0,success:function(t){t.has_paid&&(e.closePopup("qrcodePopup"),e.paySuccess(t))}});case 1:case"end":return t.stop()}}),t)})))()},_afreshPayment:function(){this.orderPayment(this.res)},_pcChooseProvider:function(e){if(e!==this.options.provider)return this.createOrder({provider:e})},_appleiapCreateOrder:function(e){var t=this;return(0,n.default)((0,p.default)().mark((function r(){var a,n,o,c,u,s,d,l;return(0,p.default)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=new appleiapSdk.Iap({products:[e.productid]}),uni.showLoading({title:"加载中..."}),r.next=4,a.init();case 4:return r.next=6,a.getProduct();case 6:return n=r.sent,o=n[0],e.total_fee=100*o.price,e.description=o.description,c={provider:e.provider,total_fee:e.total_fee,order_no:e.order_no||t.res.order_no,out_trade_no:e.out_trade_no||t.res.out_trade_no,description:e.description,type:e.type,custom:e.custom},r.next=13,i.createOrder(c);case 13:if(u=r.sent,0!==u.errCode){r.next=40;break}return t.$emit("create",u),t.res=u,uni.showLoading({title:"支付请求中..."}),r.prev=18,t.debug&&console.log("正在请求苹果服务器",e.productid,u.out_trade_no),r.next=22,a.requestPayment({productid:e.productid,username:u.out_trade_no});case 22:return s=r.sent,t.debug&&console.log("用户支付成功",s),uni.showLoading({title:"正在处理支付结果..."}),r.next=27,t.verifyReceiptFromAppleiap({out_trade_no:s.payment.username,transaction_receipt:s.transactionReceipt,transaction_identifier:s.transactionIdentifier});case 27:if(d=r.sent,0!==d.errCode){r.next=33;break}return r.next=31,a.finishTransaction(s);case 31:uni.hideLoading(),t.paySuccess(d);case 33:r.next=40;break;case 35:r.prev=35,r.t0=r["catch"](18),l=r.t0.errCode||r.t0.code,2===l?(t.debug&&console.log("用户取消支付"),t.$emit("cancel",r.t0)):(console.error("appleiapCreateOrder:fail",r.t0),t.$emit("fail",r.t0)),uni.hideLoading();case 40:case"end":return r.stop()}}),r,null,[[18,35]])})))()},appleiapRestore:function(){var e=this;return(0,n.default)((0,p.default)().mark((function t(){var r,a,n,o,i;return(0,p.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return uni.showLoading({title:"检测支付环境..."}),r=new appleiapSdk.Iap,t.next=4,r.init();case 4:return t.prev=4,e.debug&&console.log("正在查询是否有漏单信息"),t.next=8,r.restoreCompletedTransactions({username:""});case 8:if(a=t.sent,e.debug&&console.log("漏单查询结果："+(0===a.length?"未漏单":"有漏单"),a),a.length){t.next=12;break}return t.abrupt("return");case 12:n=0;case 13:if(!(n<a.length)){t.next=32;break}o=a[n],t.t0=o.transactionState,t.next=t.t0===appleiapSdk.IapTransactionState.purchased?18:t.t0===appleiapSdk.IapTransactionState.failed?25:28;break;case 18:return t.next=20,e.verifyReceiptFromAppleiap({out_trade_no:o.payment.username,transaction_receipt:o.transactionReceipt,transaction_identifier:o.transactionIdentifier});case 20:if(i=t.sent,0!==i.errCode){t.next=24;break}return t.next=24,r.finishTransaction(o);case 24:return t.abrupt("break",29);case 25:return t.next=27,r.finishTransaction(o);case 27:return t.abrupt("break",29);case 28:return t.abrupt("break",29);case 29:n++,t.next=13;break;case 32:t.next=37;break;case 34:t.prev=34,t.t1=t["catch"](4),console.error(t.t1);case 37:return t.prev=37,uni.hideLoading(),t.finish(37);case 40:case"end":return t.stop()}}),t,null,[[4,34,37,40]])})))()}},watch:{},computed:{modeCom:function(){if(this.mode)return this.mode;var e=uni.getSystemInfoSync();return e&&"pc"===e.deviceType?"pc":"mobile"}}};t.default=c}).call(this,r("a9ff")["default"])}}]);
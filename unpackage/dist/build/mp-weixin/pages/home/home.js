(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/home/home"],{"3bf3":function(t,e,o){},"4ed1":function(t,e,o){"use strict";(function(t,n){var i=o("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i(o("7ca3")),c=o("6918");function s(t,e){var o="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=function(t,e){if(!t)return;if("string"===typeof t)return r(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return r(t,e)}(t))||e&&t&&"number"===typeof t.length){o&&(t=o);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,s=!1;return{s:function(){o=o.call(t)},n:function(){var t=o.next();return c=t.done,t},e:function(t){s=!0,a=t},f:function(){try{c||null==o.return||o.return()}finally{if(s)throw a}}}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}var u={name:"index",data:function(){var t;return t={showLoading:!0,indicatorDots:!0,autoplay:!0,interval:2e3,duration:500,bannerList:[{image:"",title:"加载中",toGoodsID:"",toUrl:"",isToUrl:!1,status:!0}],noticeText:[],tabList:[],tabListSort:[{name:"综合排序"},{name:"价格"},{name:"销量"},{name:"好评度"}],src:"",address:"",beginTime:"",endTime:"",businessHours:"",customerPhone:"",latitude:0,longitude:0,city:""},(0,a.default)(t,"address",""),(0,a.default)(t,"scrollTop",0),(0,a.default)(t,"mode","square"),(0,a.default)(t,"iconStyle",{fontSize:"32rpx",color:"#409EFF"}),(0,a.default)(t,"pageNum",1),(0,a.default)(t,"pageSize",5),(0,a.default)(t,"total",0),(0,a.default)(t,"currentTabIndex",""),(0,a.default)(t,"listData",[]),(0,a.default)(t,"noticeBarShow",!1),(0,a.default)(t,"deivceWidth",0),(0,a.default)(t,"deivceHeight",0),(0,a.default)(t,"cityName","厦门市"),(0,a.default)(t,"cityID","677365c199c624a18a88fe18"),t},filters:{formatDate:function(t){var e=new Date(t),o=e.getFullYear(),n=("0"+(e.getMonth()+1)).slice(-2),i=("0"+e.getDate()).slice(-2);return"".concat(o,"-").concat(n,"-").concat(i)}},methods:{formatDate:function(t){var e=new Date(t),o=e.getFullYear(),n=("0"+(e.getMonth()+1)).slice(-2),i=("0"+e.getDate()).slice(-2);return"".concat(o,"-").concat(n,"-").concat(i)},goto:function(e){t.navigateTo({url:e})},bannerClick:function(e){console.log("轮播图当前点击图片".concat(e)),this.bannerList[e].isToUrl?-1!=this.bannerList[e].toUrl.indexOf("https")?t.navigateTo({url:"/pages/business/webView/webView?webUrl=".concat(this.bannerList[e].toUrl)}):t.navigateTo({url:this.bannerList[e].toUrl}):t.navigateTo({url:"/pages/business/goodsDetail/goodsDetail?id=".concat(this.bannerList[e].toGoodsID)})},decryptPhoneNumber:function(t){console.log(t),console.log(JSON.stringify(t.detail.encryptedData)),console.log(JSON.stringify(t.detail.iv))},openMap:function(){var e=this;t.getLocation({type:"gcj02",success:function(o){o.latitude,o.longitude;console.log("res.latitude:".concat(o.latitude," res.longitude：").concat(o.longitude)),t.openLocation({scale:18,name:"师傅服务平台-用户端",address:e.address,latitude:Number(e.latitude),longitude:Number(e.longitude),success:function(){console.log("success")}})}})},onPageScroll:function(t){this.scrollTop=t.scrollTop},getHomeBanner:function(){var t=this;n.callFunction({name:"getHomeBanner"}).then((function(e){t.bannerList=e.result.data,console.log("bannerList:",e.result.data)}))},imageLoad:function(e){var o=this,n=e.detail.width,i=e.detail.height,a=n/i,c=250,s=250*a,r=t.createSelectorQuery().in(this);r.select(".question-title").boundingClientRect((function(t){console.log(t),s>t.width&&(s=t.width,c=s/a);var e=o.images;e={width:s,height:c},console.log(e),o.images=e})).exec()},getListData:function(t){this.pageNum=1;var e=this;n.callFunction({name:"goods",data:{methods:"getGoods",sortType:t,pageNum:e.pageNum,pageSize:e.pageSize,cityName:e.cityName,cityID:e.cityID,isEnable:!0},success:function(t){console.log("getGoods res.result.data:",t.result.data),e.listData=t.result.data},fail:function(t){console.log("getGoods err:",t)}})},getCityID:function(e){var o=this;n.callFunction({name:"getCities",data:{methods:"getCityID",cityName:e},success:function(e){0===e.result.code?(o.cityID=e.result.data.cityID,console.log("城市ID:",o.cityID),t.setStorageSync("cityID",o.cityID)):(console.error("获取城市ID失败:",e.result.message),t.setStorageSync("cityID",o.cityID))},fail:function(t){console.error("调用云函数失败:",t)}})},tabListSortClick:function(t){console.log("tabListSort click",t),this.getListData(t.index)},tabListSortChange:function(t){this.pageNum=1,this.pageSize=4,this.total=0,console.log("tabListSort change",t)},tabClick:function(t){this.listData=0,this.currentTabIndex=t,console.log("tab click",this.currentTabIndex),this.getListData(t)},tabChange:function(t){this.pageNum=1,this.pageSize=10,this.total=0,console.log("tab change",t)},gotoGoodsDetail:function(e){t.navigateTo({url:"/pages/business/goodsDetail/goodsDetail?goodsID=".concat(e)})},selectTherapist:function(e){console.log("选择理疗师",e),t.setStorageSync("goodsID",e._id),console.log("home goodsID:",e._id),t.setStorageSync("isHomeGoTo",!0),t.switchTab({url:"/pages/worker/worker"})},getBasicInforMation:function(){n.callFunction({name:"getBasicInformation",data:{isEnable:!0},success:function(e){t.setStorageSync("basicInformation",e.result.data[0]),console.log("home basicInformation:",e.result.data[0])}})},getNoticeBar:function(){var t=this,e=this;n.callFunction({name:"getNoticeBar",data:{isEnable:!0},success:function(o){console.log("res.result.data",o.result.data);var n,i=s(o.result.data);try{for(i.s();!(n=i.n()).done;){var a=n.value;console.log("elm.title",a.title),e.noticeText.push(a.title)}}catch(c){i.e(c)}finally{i.f()}e.noticeText=JSON.parse(JSON.stringify(e.noticeText)),console.log("that.noticeText:",JSON.parse(JSON.stringify(e.noticeText))),t.noticeText.length>0?t.noticeBarShow=!0:t.noticeBarShow=!1}})},getDeivceWidthHeight:function(){this.deivceHeight=t.getSystemInfoSync().windowHeight,this.deivceWidth=t.getSystemInfoSync().windowWidth,console.log("deivceWidth",this.deivceWidth),console.log("deivceHeight",this.deivceHeight)},getLocationGaoDe:function(){var e=this;t.getLocation({type:"gcj02",success:function(t){console.log("经度：",t.longitude),console.log("纬度：",t.latitude),console.log("速度：",t.speed),console.log("精度：",t.accuracy),e.latitude=t.latitude,e.longitude=t.longitude,e.getLocationGaoDeInfo(t.latitude,t.longitude)},fail:function(t){console.error("获取位置失败",t)}})},getLocationGaoDe2:function(){var e=this;t.getLocation({isHighAccuracy:!0,type:"gcj02",success:function(t){var o=t.latitude,n=t.longitude;console.log("原始经度："+n+"，原始纬度："+o);var i=n,a=o,c=52.35987755982988,s=Math.sqrt(i*i+a*a)+2e-5*Math.sin(a*c),r=Math.atan2(a,i)+3e-6*Math.cos(i*c),u=s*Math.cos(r)+.0065,l=s*Math.sin(r)+.006;console.log("加偏移后经度："+u+"，加偏移后纬度："+l),console.log("当前速度："+t.speed+"米/秒"),e.latitude=l,e.longitude=u,e.getLocationGaoDeInfo(e.latitude,e.longitude)},fail:function(t){console.log("获取定位失败："+t.errMsg)}})},getLocationGaoDeInfo:function(e,o){var n=this;(0,c.getUserCurrentLocationInfo)(e,o).then((function(e){n.city=e[0].regeocodeData.addressComponent.city||e[0].regeocodeData.addressComponent.province,n.address=e[0].regeocodeData.formatted_address,console.log("城市：",n.city),t.setStorageSync("cityName",n.city),console.log("详细地址：",n.address),n.getCityID(n.city)})).catch((function(t){console.error("逆地理编码失败",t)}))},userAuthorization:function(){var e=this;t.authorize({scope:"scope.userLocation",success:function(){e.getLocationTenCent()}})},getLocationTenCent:function(){var e=this;t.getFuzzyLocation({success:function(t){e.longitude=t.longitude,e.latitude=t.latitude,console.log("经度：",e.longitude),console.log("纬度：",e.latitude),e.getLocationTenCentInfo(e.latitude,e.longitude)}})},getLocationTenCentInfo:function(e,o){var n=this;t.request({url:"https://apis.map.qq.com/ws/geocoder/v1/?location=".concat(encodeURIComponent(e),",").concat(encodeURIComponent(o),"&key=").concat("\t35XBZ-AWKKU-6IGVA-GVBZV-EJK5J-32FVT","&get_poi=1"),method:"GET",success:function(t){console.log(t),n.address=t.data.result.ad_info.city}})}},components:{},created:function(){console.log("当前页面:home")},onReachBottom:function(){},onLoad:function(e){e.shareOpenID&&(t.setStorageSync("shareOpenID",e.shareOpenID),console.log("分享人的OpenID:",e.shareOpenID)),t.setStorageSync("cityName",this.cityName),t.setStorageSync("cityID",this.cityID),this.getHomeBanner(),this.getListData(0),this.getNoticeBar(),this.getDeivceWidthHeight(),this.getLocationGaoDe(),this.getBasicInforMation()},onShareAppMessage:function(){return{title:"上上吉",path:"/pages/home/home"}},onShareTimeline:function(){return{title:"上上吉",imageUrl:"https://mp-e51575a6-5952-4ad5-bb31-45ff909d7f65.cdn.bspapp.com/cloudstorage/c89fedc8-0f75-4e8e-b151-ce90a17e7ce3.jpg"}}};e.default=u}).call(this,o("df3c")["default"],o("861b")["uniCloud"])},"6f39":function(t,e,o){"use strict";o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return a})),o.d(e,"a",(function(){return n}));var n={uNoticeBar:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uview-ui/components/u-notice-bar/u-notice-bar")]).then(o.bind(null,"d4f3"))},uSwiper:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uview-ui/components/u-swiper/u-swiper")]).then(o.bind(null,"ff99"))},uSticky:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uview-ui/components/u-sticky/u-sticky")]).then(o.bind(null,"e708"))},uniCard:function(){return o.e("uni_modules/uni-card/components/uni-card/uni-card").then(o.bind(null,"2d19"))},uTabs:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uview-ui/components/u-tabs/u-tabs")]).then(o.bind(null,"cac3"))},uRow:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uview-ui/components/u-row/u-row")]).then(o.bind(null,"926a"))},uCol:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uview-ui/components/u-col/u-col")]).then(o.bind(null,"7108"))},uBackTop:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uview-ui/components/u-back-top/u-back-top")]).then(o.bind(null,"8985"))}},i=function(){var t=this.$createElement;this._self._c},a=[]},"9d1f":function(t,e,o){"use strict";o.r(e);var n=o("4ed1"),i=o.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){o.d(e,t,(function(){return n[t]}))}(a);e["default"]=i.a},b531:function(t,e,o){"use strict";o.r(e);var n=o("6f39"),i=o("9d1f");for(var a in i)["default"].indexOf(a)<0&&function(t){o.d(e,t,(function(){return i[t]}))}(a);o("c86f");var c=o("828b"),s=Object(c["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);e["default"]=s.exports},c322:function(t,e,o){"use strict";(function(t,e){var n=o("47a9");o("34db"),o("3c60"),o("c891"),o("861b");n(o("3240"));var i=n(o("b531"));t.__webpack_require_UNI_MP_PLUGIN__=o,e(i.default)}).call(this,o("3223")["default"],o("df3c")["createPage"])},c86f:function(t,e,o){"use strict";var n=o("3bf3"),i=o.n(n);i.a}},[["c322","common/runtime","common/vendor"]]]);
(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/list/search/search"],{7413:function(t,e,i){},"772f":function(t,e,i){"use strict";i.r(e);var n=i("d543"),a=i.n(n);for(var c in n)["default"].indexOf(c)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(c);e["default"]=a.a},"8eaf":function(t,e,i){},9111:function(t,e,i){"use strict";i.r(e);var n=i("b622"),a=i("772f");for(var c in a)["default"].indexOf(c)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(c);i("fe29"),i("e2c7"),i("c4d0");var o=i("828b"),s=Object(o["a"])(a["default"],n["b"],n["c"],!1,null,"2cbf578a",null,!1,n["a"],void 0);e["default"]=s.exports},aa4e:function(t,e,i){"use strict";(function(t,e){var n=i("47a9");i("34db"),i("3c60"),i("c891"),i("861b");n(i("3240"));var a=n(i("9111"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(a.default)}).call(this,i("3223")["default"],i("df3c")["createPage"])},b622:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return c})),i.d(e,"a",(function(){return n}));var n={uniSearchBar:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uni-search-bar/components/uni-search-bar/uni-search-bar")]).then(i.bind(null,"1c94"))},unicloudDb:function(){return Promise.all([i.e("common/vendor"),i.e("node-modules/@dcloudio/uni-cli-shared/components/unicloud-db")]).then(i.bind(null,"3220"))},uniList:function(){return i.e("uni_modules/uni-list/components/uni-list/uni-list").then(i.bind(null,"1425"))},uniListItem:function(){return i.e("uni_modules/uni-list/components/uni-list-item/uni-list-item").then(i.bind(null,"8d53"))}},a=function(){var t=this,e=t.$createElement,i=(t._self._c,t.localSearchList.length),n=t.$hasSSP("d9c30b22-6"),a=n?t.$getSSP("d9c30b22-6","default")["loading"]&&!t.netHotListIsHide:null,c=!n||a||t.netHotListIsHide?null:t.$getSSP("d9c30b22-6","default"),o=n&&!a&&!t.netHotListIsHide&&c["error"]?t.$getSSP("d9c30b22-6","default"):null,s=!n||a||t.netHotListIsHide||c["error"]?null:t.$getSSP("d9c30b22-6","default");t._isMounted||(t.e0=function(e){t.localSearchListDel=!0},t.e1=function(e){t.localSearchListDel=!1},t.e2=function(e){t.netHotListIsHide=!t.netHotListIsHide},t.e3=function(e,i){var n=arguments[arguments.length-1].currentTarget.dataset,a=n.eventParams||n["event-params"];i=a.word;return t.search(i.content)}),t.$mp.data=Object.assign({},{$root:{g0:i,m0:n,m1:a,m2:c,m3:o,m4:s}})},c=[]},c4d0:function(t,e,i){"use strict";var n=i("fcb3"),a=i.n(n);a.a},d543:function(t,e,i){"use strict";(function(t,n){var a=i("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var c=a(i("7ca3"));var o={data:function(){return{mallGoodsDbName:"opendb-news-articles",searchLogDbName:"opendb-search-log",statusBarHeight:"0px",localSearchList:t.getStorageSync("__local_search_history"),localSearchListDel:!1,netHotListIsHide:!1,searchText:"",iconColor:"#999999",associativeList:[],keyBoardPopup:!1,hotWorld:"DCloud",focus:!0,speechEngine:"iFly"}},created:function(){var e=this;this.db=n.database(),this.searchLogDb=this.db.collection(this.searchLogDbName),this.mallGoodsDb=this.db.collection(this.mallGoodsDbName),t.onKeyboardHeightChange((function(t){e.keyBoardPopup=0!==t.height})),this.searchText=getApp().globalData.searchText},computed:{associativeShow:function(){return this.searchText&&this.associativeList.length}},onLoad:function(){},methods:{clear:function(t){console.log("res: ",t)},confirm:function(t){this.search(t.value)},cancel:function(e){t.hideKeyboard(),this.searchText="",this.loadList()},search:function(e){(e||this.hotWorld)&&(e?(this.searchText!==e&&(this.searchText=e),this.localSearchListManage(e),this.searchLogDbAdd(e)):this.hotWorld&&(this.searchText=this.hotWorld),t.hideKeyboard(),this.loadList(this.searchText))},localSearchListManage:function(e){var i=t.getStorageSync("__local_search_history");i.length?(this.localSearchList.unshift(e),function(t){for(var e=t.length-1;e>=0;e--){var i=t.indexOf(t[e]),n=t.lastIndexOf(t[e]);i!=n&&t.splice(n,1)}}(this.localSearchList),this.localSearchList.length>10&&this.localSearchList.pop()):this.localSearchList=[e],t.setStorageSync("__local_search_history",this.localSearchList)},LocalSearchListClear:function(){var e=this;t.showModal({content:"确认清空搜索历史吗",confirmText:"删除",confirmColor:"red",cancelColor:"#808080",success:function(i){i.confirm&&(e.localSearchListDel=!1,e.localSearchList=[],t.removeStorageSync("__local_search_history"))}})},LocalSearchlistItemClick:function(e,i){if(this.localSearchListDel)return this.localSearchList.splice(i,1),t.setStorageSync("__local_search_history",this.localSearchList),void(this.localSearchList.length||(this.localSearchListDel=!1));this.search(e)},searchHotRefresh:function(){this.$refs.udb.refresh()},speech:function(){},searchLogDbAdd:function(t){var e=this;this.getDeviceId().then((function(i){e.searchLogDb.add({device_id:i,content:t,create_date:Date.now()})}))},getDeviceId:function(){return new Promise((function(e,i){var n=t.getStorageSync("uni_id");e(n||t.getSystemInfoSync().system+"_"+Math.random().toString(36).substr(2))}))},associativeClick:function(t){console.log("associativeClick: ",t),this.loadList(t.title)},loadList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";getApp().globalData.searchText=e,t.switchTab({url:"/pages/list/list"})},backPage:function(){t.navigateBack()}},watch:{searchText:function(t,e,i){var n=t,a=null,c=!0;return i&&n(),function(){var t=arguments,i=this;c&&(c=!1,n.apply(i,t)),a&&clearTimeout(a),a=setTimeout((function(){clearTimeout(a),a=null,n.apply(i,t)}),e||200)}}((function(t){var e=this;t?this.mallGoodsDb.where((0,c.default)({},"title",new RegExp(t,"gi"))).field("_id,title").get().then((function(t){e.associativeList=t.result.data})):(this.associativeList.length=0,getApp().globalData.searchText="")}),100)}};e.default=o}).call(this,i("df3c")["default"],i("861b")["uniCloud"])},e2c7:function(t,e,i){"use strict";var n=i("8eaf"),a=i.n(n);a.a},fcb3:function(t,e,i){},fe29:function(t,e,i){"use strict";var n=i("7413"),a=i.n(n);a.a}},[["aa4e","common/runtime","common/vendor"]]]);